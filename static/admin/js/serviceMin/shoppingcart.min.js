//需要引入jquery.fly.min.js 抛物线插件
var dingdan=[],itemShop=[],shopcart={init:function(){shopcart.renderShop()},buyCLick:function(){var a=$("#end").offset(),c;mmg.on("cellSelected",function(b,g,f,d){if($(b.target).is(".J-goumai")){b.stopPropagation();c=$(b.target);if(c.hasClass("active"))return!1;c.addClass("active");itemShop.push(g);mmg.select(f);$('\x3ci class\x3d"iconfont"\x3e\x26#xe632;\x3c/i\x3e').fly({start:{left:event.pageX,top:event.pageY},end:{left:a.left+10,top:a.top+10,width:0,height:0},onEnd:function(){$("#msg").show().animate({width:"250px"},200).fadeOut(1E3);shopcart.renderList();this.destory()}})}})},renderShop:function(){shopcart.buyCLick();var a=$(".sidebarWrapper");$(".J-shopbtn").on("click",function(){a.hasClass("open")?$(a).removeClass("open"):($(a).addClass("open"),$("body").on("click",".J-closeSide",function(c){c.preventDefault();$(a).removeClass("open")}))})},renderList:function(){shopcart.buyCLick();$(".J-counts").text(itemShop.length);dingdan=[];for(var a=0;a<itemShop.length;a++)dingdan.push({proId:itemShop[a].id,price:itemShop[a].price,number:1});a=template("tplShop",{list:itemShop});$(".J-shop-cont").html(a);for(var c=0,a=0;a<$(".J-result").length;a++)c+=parseInt($(".J-result").eq(a).text());$(".J-total").text(c);$(".J-dels").on("click",function(){var b=$(this).parent().parent().index(),a=mmg.find("tbody tr.selected").eq(b);itemShop.splice(b,1);shopcart.renderList();a.removeClass("selected");a.find("input").attr("checked",!1);a.find(".J-goumai").removeClass("active")});$(".J-edits").on("click",function(b){b.preventDefault();b=$(this);var a=b.text(),c=b.parent().parent().index(),d=b.parent().parent().find("input");"\u4fee\u6539"==a?(b.text("\u4fdd\u5b58"),d.attr("readonly",!1)):(b.text("\u4fee\u6539"),d.attr("readonly",!0),dingdan[c].counts=parseFloat(d.val()))});$(".J-count").on("change",function(b){b.preventDefault();var a=$(this);b=parseFloat(a.val());var c=a.parent().find(".J-result"),a=parseFloat(a.parent().find(".J-price").text());c.text(parseFloat(b*a));for(b=ress=0;b<$(".J-result").length;b++)ress+=parseInt($(".J-result").eq(b).text());$(".J-total").text(ress)});$(".J-xiadan").on("click",function(a){a.preventDefault();a=[];for(var c=[],f=[],d={},e=0;e<dingdan.length;e++)a.push(dingdan[e].proId),c.push(dingdan[e].price),f.push(dingdan[e].number);d.proId=a;d.price=c;d.number=f;d.total=parseFloat($(".J-total").text());common.ajaxFunIframe($agentOrders.add.url,d,function(){},function(){1==ajaxData.success&&common.iframeLayerMsg("\u4e0b\u5355\u6210\u529f",1,function(){var a=$.hash("page");"shangpin"==a&&(pager="qdingdan");"shangpinguanli"==a&&(pager="dingdan");index.navClick(pager)})})})}};
//@ sourceMappingURL=shoppingcart.min.js.map