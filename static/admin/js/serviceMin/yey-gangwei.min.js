options=[];var bag={_init:function(){var a=$roles;common.powerFlag(temD[1].power);var b=[{title:"\u5c97\u4f4d\u540d",name:"roleName",width:120,align:"center"},{title:"code",name:"code",width:30,align:"center"},{title:"\u521b\u5efa\u65f6\u95f4",name:"insertDate",width:100,align:"center"},{title:"\u72b6\u6001",name:"isUse",width:30,align:"center",renderer:function(a){null==a&&(a=1);return state=1==a?"\u221a":"X"}},{title:"\u64cd\u4f5c",name:"code",width:80,align:"center",renderer:function(a,b){btnsHtml="\x3ca class\x3d'iconfont J-info' href\x3d'javascript:void(0);' title\x3d'\u8be6\u60c5'\x3e\x26#xe61c;\x3c/a\x3e";btnsHtml=0==b.isUse?btnsHtml+"\x3ca class\x3d'iconfont J-qiyong' data-id\x3d'1' href\x3d'javascript:void(0);' title\x3d'\u542f\u7528'\x3e\x26#xe630;\x3c/a\x3e":btnsHtml+"\x3ca class\x3d'iconfont J-tingyong' href\x3d'javascript:void(0);' title\x3d'\u505c\u7528'\x3e\x26#xe625;\x3c/a\x3e";"JZG"!=a&&"SJ"!=a&&"LS"!=a&&"JS"!=a?(editFlagS&&(btnsHtml+="\x3ca class\x3d'iconfont J-edit' href\x3d'javascript:void(0);' title\x3d'\u7f16\u8f91'\x3e\x26#xe61a;\x3c/a\x3e"),delFlag&&(btnsHtml+="")):btnsHtml+="\x3ca class\x3d'iconfont J-quanxian' data-id\x3d'1' href\x3d'javascript:void(0);' title\x3d'\u6743\u9650\u5206\u914d'\x3e\x26#xe630;\x3c/a\x3e";return"\x3cspan class\x3d'table-action'\x3e"+btnsHtml+"\x3c/span\x3e"}}],e=common.getCode();if(1==e||2==e||3==e)b.splice(2,0,{title:"\u5b66\u6821",name:"schoolName",width:90,align:"center"}),b.splice(3,0,{title:"\u73ed\u7ea7",name:"className",width:90,align:"center"});options.push({tpl:{edit:"editTpl",chk:"chkTpl",add:"addTpl"},url:{edit:a.edit.url,add:a.add.url,del:a.del.url,list:a.list.url},area:{edit:a.edit.area,add:a.add.area,del:a.del.area,chk:a.chk.area},title:{edit:a.edit.title,add:a.add.title,del:a.del.title,chk:a.chk.title,titleStart:a.del.titleStart,titleEnd:a.del.titleEnd},callback:{add:function(){common.codeFlag(function(){var a=$(".layui-layer .J-school");common.getSchoolItem(a,{page:0,count:0},0,function(){})},function(){$(".J-school").html($(".J-sc").text())})},edit:function(){common.codeFlag(function(){var a=$(".layui-layer .J-school");common.getSchoolItem(a,{page:0,count:0},0,function(){},{schoolId:datasCur.schoolId,schoolName:datasCur.schoolName})},function(){})},chk:function(){}},mmg:{indexCol:!0,checkCol:!0,root:"list"}});bag._do(b,options)},mmgSelects:function(){mmg.on("cellSelected",function(a,b,e,f){if($(a.target).is(".J-quanxian")){a.stopPropagation();datasCur=b;var g=$roleprivs.list.url;common.ajaxSubmitV(g,[],function(){datasQx=ajaxDatas.list;common.ajaxSubmitV(g,{roleId:datasCur.id},function(){if((currenQx=ajaxDatas.list)&&0<currenQx.length)for(var a=0;a<currenQx.length;a++)for(var b=0;b<datasQx.length;b++){if(currenQx[a].privId==datasQx[b].privId){var c=currenQx[a].power,c=c.split(",");datasQx[b].powersFlag=1;datasQx[b].powerChk=c[0];datasQx[b].powerAdd=c[1];datasQx[b].powerEdit=c[2];datasQx[b].powerDel=c[3]}}else for(a=0;a<datasQx.length;a++)c=datasQx[a].power,c=c.split(","),datasQx[a].powersFlag=0,datasQx[a].powerChk=c[0],datasQx[a].powerAdd=c[1],datasQx[a].powerEdit=c[2],datasQx[a].powerDel=c[3];var a=template("tplRoleprivs",{list:datasQx}),e=layer.open({title:"\u6743\u9650\u5206\u914d",content:a,type:1,area:["500px","500px"],btn:["\u786e\u5b9a"],success:function(){$(".J-all-check").on("click",function(){var a=$(this),d=a.parent().parent().find(".J-check");a.prop("checked")?d.prop("checked",!0):d.prop("checked",!1)});$(".J-check").on("click",function(){var a=$(this),d=a.parent().parent().find(".J-all-check");a.prop("checked")?(d.prop("checked",!0),a.prop("checked",!0)):a.prop("checked",!1);a=$("#mmgRolePrivs tbody tr");for(d=0;d<a.length;d++){var b=$(a).eq(d).find(".powerChk").prop("checked"),c=$(a).eq(d).find(".powerAdd").prop("checked"),e=$(a).eq(d).find(".powerEdit").prop("checked"),f=$(a).eq(d).find(".powerDel").prop("checked");1==b&&1==c&&1==e&&1==f&&$(a).eq(d).find(".J-all-check").prop("checked",!0);0==b&&0==c&&0==e&&0==f&&$(a).eq(d).find(".J-all-check").prop("checked",!1)}})},yes:function(){for(var a=[],b=0;b<$(".J-all-check").length;b++){var c=$(".J-all-check").eq(b).parent().parent();_PrivName=c.find(".privName").val();_RoleId=c.find(".roleId").val();_PrivId=c.find(".privId").val();_Add=c.find(".powerAdd").prop("checked");_Add=1==_Add?1:0;_Del=c.find(".powerDel").prop("checked");_Del=1==_Del?1:0;_Edit=c.find(".powerEdit").prop("checked");_Edit=1==_Edit?1:0;_Chk=c.find(".powerChk").prop("checked");_Chk=1==_Chk?1:0;_powerString=_Chk+","+_Add+","+_Edit+","+_Del;$(".J-all-check").eq(b).prop("checked")&&a.push({privName:_PrivName,roleId:datasCur.id,privId:_PrivId,power:_powerString})}b=$roleprivs.edit.url;c=function(){layer.msg("\u6dfb\u52a0\u6210\u529f",1,function(){layer.close(e);mmg.load()})};quanxianAdd=[{name:"roleprivsJson",value:JSON.stringify(a)}];0<a.length&&common.ajaxSubmitV(b,quanxianAdd,c)}})})})}})},_do:function(a,b){var e=function(){bag.searchRest();common.creatSearch();void 0==mmg||null==mmg?mainCont.getList(a,b):(common.creatSearch(),mmg.load(_dataParams));if(mmg)mmg.on("loadSuccess",function(){bag.mmgSelects()})};common.codeFlag(function(){var a=$(".action .J-school");common.getSchoolItem(a,{page:0,count:0},0,e)},function(){e()})},searchRest:function(){$("#isUse").val("");$("#keywords").val("")}};bag._init();
//@ sourceMappingURL=yey-gangwei.min.js.map