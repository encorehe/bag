options=[];var bag={_init:function(){var a=$classAlbums;common.powerFlag(temD[1].power);var e=[{title:"\u76f8\u518c\u6807\u9898",name:"title",width:120,align:"center"},{title:"\u73ed\u7ea7",name:"className",width:90,align:"center"},{title:"\u7c7b\u578b",name:"fileType",width:30,align:"center",renderer:function(b,a){var d="";null==b&&(b=3);switch(b){case 1:d="\u7167\u7247";break;case 2:d="\u89c6\u9891";break;case 3:d="\u89c6\u9891\u6216\u7167\u7247"}return d}},{title:"\u72b6\u6001",name:"isUse",width:30,align:"center",renderer:function(b,a){null==b&&(b=1);return state=1==b?"\x3cspan class\x3d'f-blue'\x3e\u221a\x3c/span\x3e":"\x3cspan class\x3d'f-red'\x3eX\x3c/span\x3e"}},{title:"\u521b\u5efa\u65f6\u95f4",name:"insertDate",width:60,align:"center"},{title:"\u64cd\u4f5c",name:"fileType",width:60,align:"center",renderer:function(b,a){delBtnsEnd="\x3ca class\x3d'iconfont J-tingyong' href\x3d'javascript:void(0);' title\x3d'\u505c\u7528'\x3e\x26#xe625;\x3c/a\x3e";delBtnsStart="\x3ca class\x3d'iconfont J-qiyong' data-id\x3d'1' href\x3d'javascript:void(0);' title\x3d'\u542f\u7528'\x3e\x26#xe630;\x3c/a\x3e";imgBtns="\x3ca class\x3d'iconfont J-img' href\x3d'javascript:void(0);' title\x3d'\u67e5\u770b\u7167\u7247'\x3e\x26#xe602;\x3c/a\x3e";btnsHtml="\x3ca class\x3d'iconfont J-info' href\x3d'javascript:void(0);' title\x3d'\u8be6\u60c5'\x3e\x26#xe61c;\x3c/a\x3e";btnsHtml=0==a.isUse?btnsHtml+delBtnsStart:btnsHtml+delBtnsEnd;editFlagS&&null!=b&&(btnsHtml+="\x3ca  class\x3d'iconfont J-edit' href\x3d'javascript:void(0);' title\x3d'\u7f16\u8f91'\x3e\x26#xe61a;\x3c/a\x3e");delFlag&&(btnsHtml+="");return"\x3cspan class\x3d'table-action'\x3e"+btnsHtml+imgBtns+"\x3c/span\x3e"}}],c=common.getCode();1!=c&&2!=c&&3!=c||e.splice(1,0,{title:"\u5b66\u6821",name:"schoolName",width:90,align:"center"});options.push({tpl:{edit:"editTpl",chk:"chkTpl",add:"addTpl"},url:{edit:a.edit.url,add:a.add.url,del:a.del.url,list:a.list.url},area:{edit:a.edit.area,add:a.add.area,del:a.del.area,chk:a.chk.area},title:{edit:a.edit.title,add:a.add.title,del:a.del.title,chk:a.chk.title,titleStart:a.del.titleStart,titleEnd:a.del.titleEnd},callback:{add:function(){var b=$(".J-school"),a=$(".J-class"),d=$(".J-date");common.codeFlag(function(){common.getSchoolAndClassItem(b,1,a,1,function(){common.layerDateYYMM(d)})},function(){b.text($(".J-sc").text());common.getClass(a,1,{page:0,count:0},function(){common.layerDateYYMM(d)})})},edit:function(){var a=$(".J-school"),c=$(".J-class"),d=$(".J-date"),e=$("#kidNo");common.codeFlag(function(){common.getSchoolAndClassItem(a,1,c,1,function(){},{schoolId:datasCur.schoolId,schoolName:datasCur.schoolName},{classId:datasCur.classId,className:datasCur.className})},function(){a.text($(".J-sc").text());common.getClass(c,1,{page:0,count:0},function(){},{classId:datasCur.classId,className:datasCur.className})});e.val(datasCur.kidNO);common.layerDateYYMM(d)},chk:function(){var a=$(window.parent.document),c=a.find(".J-school"),d=a.find(".J-class");c.text($(".J-schools select option:selected").text());d.text($(".J-classs select option:selected").text());a.find(".layui-layer-btn").remove()}},mmg:{indexCol:!0,checkCol:!0,root:"list"}});bag._do(e,options)},_do:function(a,e){var c=function(){bag.searchRest();common.creatSearch();void 0==mmg||null==mmg?mainCont.getList(a,e):(common.creatSearch(),mmg.load(_dataParams));mmg&&bag.mmgSelects()};common.codeFlag(function(){var a=$(".action .J-schools"),e=$(".action .J-classs");common.getSchoolAndClassItem(a,0,e,0,function(){_dataParams.page=1;c()})},function(){var a=$(".J-classs"),e={page:0,count:0,schoolId:$.cookie("bag-schoolId")};common.getClass(a,0,e,c)})},renderPhotos:function(a){var e=Date.parse(new Date),c=$imgVidos.list.url,b={classAlbumId:datasCur.id,fileType:1,page:1,count:24};common.ajaxSubmitV(c,b,function(){if(ajaxDatas.success){var h=Math.ceil(ajaxDatas.totalCount/24);isp=0;var d=[],f=[];laypage({cont:"biuuu_city",pages:h,jump:function(k){isp++;curPage=k.curr;b.page=curPage;var g="";common.ajaxSubmitV(c,b,function(){0<ajaxDatas.list.length?$(".no-empty").hide():$(".no-empty").show();a.html(template("tplPhotos",{list:ajaxDatas.list,time:e}));var b=$("#lightgallery");b.lightGallery({hash:!1});b.on("onBeforeClose.lg",function(a,b,d,c){g=$.hash("page")});b.on("onCloseAfter.lg",function(a,b,d,c){$.hash("page",g)});0<isp&&(b.data("lightGallery").destroy(!0),b.lightGallery({hash:!1}));$("#lightgallery span").on("click",function(a){a.stopPropagation();var b=$(this).find('input[name\x3d"imgId"]');a=b.prop("checked");var c=b.parent().parent(),b=c.data("id"),c=c.data("filepath");if(a)d.push(b),f.push(c);else for(a=0;a<d.length;a++)b==d[a]&&(d.splice(a,1),f.splice(a,1),a--)});$(".J-reset-btn").on("click",function(a){a.preventDefault();$("#lightgallery").find("a").removeClass("active");$(".del-action").removeClass("active");$('input[name\x3d"imgId"]').prop("checked",!1);d=[];f=[]});$(".J-yes-btn").unbind("click").on("click",function(a){a.preventDefault();$(this).addClass("disabled");if(0==d.length)common.iframeLayerMsg("\u8bf7\u5148\u9009\u4e2d\u9700\u8981\u5220\u9664\u7684\u7167\u7247",0,function(){$(".J-yes-btn").removeClass("disabled")});else{a=d.join();var b=f.join();common.ajaxSubmitV($imgVidos.del.url,{id:a,fileName:b,type:1},function(){common.iframeLayerMsg("\u7167\u7247\u5220\u9664\u6210\u529f",1,function(){$(".del-action").removeClass("active");$(".J-yes-btn").removeClass("disabled");bag.renderPhotos($(".J-photo"))})})}});$(".J-checkAlls").on("click",function(){if($(this).find('input[name\x3d"imgIdAll"]').prop("checked")){$('input[name\x3d"imgId"]').prop("checked",!0);for(var a=ajaxDatas.list,b=0;b<a.length;b++)d.push(a[b].id),f.push(a[b].filePath)}else $('input[name\x3d"imgId"]').prop("checked",!1)})})}});$(".J-delAll").on("click",function(){$("#lightgallery").find("a").addClass("active");$(".del-action").addClass("active")});$(".J-addPic").unbind("click").on("click",function(){var a=$.cookie("bag-user-id"),b=datasCur.id,c=template("tplUp",{classAlbumId:b,accountId:a});common.layerBox("\u4e0a\u4f20\u7167\u7247",["600px","370px"],c,function(){common.upPhoto($("#fileName"),function(){0<$file.files.length?$(".J-up").removeClass("disabled"):$(".J-up").addClass("disabled");$(".J-up").unbind("click").on("click",function(c){c.preventDefault();$(this).addClass("disabled");indexLoading=layer.load(1,{shade:[.1,"#fff"]});c=$("#fileName").prop("files");var d=c.length,e=0;$.each(c,function(c,f){$.ajax({url:$qiniuImg.url,type:"post",cache:!1,dataType:"json",success:function(f){1==f.success&&(Q.AddParams("x:classAlbumId",b),Q.AddParams("x:type",1),Q.AddParams("x:accountId",a),Q.AddParams("x:isCover",0),Q.AddParams("x:teacherSaidId",0),Q.AddParams("x:ordinal",0),Q.addEvent("putFinished",function(a,b,c){e++;e==d&&(layer.close(indexLoading),bag.renderPhotos($(".J-photo")),layer.close(layerBox))}),Q.addEvent("putFailure",function(a){alert(a)}),Q.SetToken(f.qiniuTokenStr),Q.Upload($("#fileName").prop("files")[c]))}})})})})})})}})},mmgSelects:function(){mmg.on("cellSelected",function(a,e,c,b){datasCur=e;$(a.target).is(".J-img")&&(a=template("photoList",{}),common.layerBox("\u76f8\u518c",["850px","480px"],a,function(){$(".layui-layer-btn").remove();accountId=$.cookie("bag-user-id");bag.renderPhotos($(".J-photo"))}))})},formEmpty:function(){$(parent.document).find(".J-add-form").empty();$(parent.document).find(".J-btn-add").removeClass("disabled")},ajaxSubmitV:function(a,e,c){$.ajax({type:"post",url:a,data:e,dataType:"json",success:function(a){ajaxDatas=a;c&&c()}})},searchRest:function(){$("#isUse").val("");$("#gender").val("");$("#keyWords").val("")}};bag._init();
//@ sourceMappingURL=yey-banjixiangce.min.js.map