options=[];var bag={_init:function(){var e=$kid;common.powerFlag(temD[0].power);var d=[{title:"\u5b9d\u8d1d\u57fa\u672c\u4fe1\u606f",align:"center",cols:[{title:"\u5934\u50cf",name:"icon",width:46,align:"center",renderer:function(b,c){var a="";return a=null==b||""==b?null==c.gender||1==c.gender?"\x3cspan class\x3d'avatarMan'\x3e\u7537\x3c/span\x3e":"\x3cspan class\x3d'avatarWomen'\x3e\u5973\x3c/span\x3e":"\x3cspan class\x3d'imgPhoto'\x3e\x3cimg src\x3d'http://image.bag61.com/"+b+"'  width\x3d'36px' height\x3d'36px' /\x3e\x3c/span\x3e"}},{title:"\u59d3\u540d/\u82f1\u6587\u540d",name:"name",width:100,align:"center",renderer:function(b,c){var a=c.enName,f=c.name;return""==f&&""==a?"\u672a\u8f93\u5165":""==a||null==a?f:""==f||null==f?a:f+"/"+a}},{title:"\u6027\u522b",name:"gender",width:30,align:"center",renderer:function(b){null==b&&(b=1);return sex=1==b?"\u7537":"\u5973"}}]},{title:"\u5165\u56ed\u4fe1\u606f",align:"center",cols:[{title:"\u72b6\u6001",name:"isUse",width:30,align:"center",renderer:function(b){null==b&&(b=1);return state=1==b?"\u221a":"X"}},{title:"\u73ed\u7ea7",name:"className",width:100,align:"center"},{title:"\u8d1d\u8d1d\u53f7",name:"kidNO",width:80,align:"center"},{title:"\u95e8\u7981\u5361\u6570\u91cf",name:"rfIdCount",width:40,align:"center"},{title:"\u5165\u5b66\u65e5\u671f",name:"registerTime",width:100,align:"center",hidden:!0},{title:"\u521b\u5efa\u65f6\u95f4",name:"insertDate",width:90,align:"center"},{title:"\u5728\u7ebf\u89c6\u9891",name:"hasOnlineVideo",width:100,align:"center",hidden:!0},{title:"\u89c6\u9891\u5230\u671f\u65e5",name:"videoExpirationDate",width:100,align:"center",hidden:!0},{title:"\u5b9a\u4f4d\u4fe1\u606f",name:"enPosition",width:30,align:"center",hidden:!0}]},{title:"\u64cd\u4f5c",width:100,align:"center",renderer:function(b,c){btnsHtml="\x3ca class\x3d'iconfont J-info' href\x3d'javascript:void(0);' title\x3d'\u8be6\u60c5'\x3e\x26#xe61c;\x3c/a\x3e";btnsHtml=0==c.isUse?btnsHtml+"\x3ca class\x3d'iconfont J-qiyong' data-id\x3d'1' href\x3d'javascript:void(0);' title\x3d'\u542f\u7528'\x3e\x26#xe630;\x3c/a\x3e":btnsHtml+"\x3ca class\x3d'iconfont J-tingyong' href\x3d'javascript:void(0);' title\x3d'\u505c\u7528'\x3e\x26#xe625;\x3c/a\x3e";1==editFlagS&&(btnsHtml+="\x3ca class\x3d'iconfont J-edit' href\x3d'javascript:void(0);' title\x3d'\u7f16\u8f91'\x3e\x26#xe61a;\x3c/a\x3e");1==delFlag&&(btnsHtml+="");return"\x3cspan class\x3d'table-action'\x3e"+btnsHtml+"\x3ca class\x3d'iconfont J-addPer' data-id\x3d'1' href\x3d'javascript:void(0);' title\x3d'\u76d1\u62a4\u4eba\u4fe1\u606f'\x3e\x26#xe639;\x3c/a\x3e\x3ca class\x3d'iconfont J-card' data-id\x3d'1' href\x3d'javascript:void(0);' title\x3d'\u95e8\u7981\u5361\u4fe1\u606f'\x3e\x26#xe61d;\x3c/a\x3e\x3c/span\x3e"}}],g=common.getCode();1!=g&&2!=g&&3!=g||d[0].cols.push({title:"\u5b66\u6821",name:"schoolName",width:90,align:"center"});options.push({tpl:{edit:"editTpl",chk:"chkTpl",add:"addTpl"},url:{edit:e.edit.url,add:e.add.url,del:e.del.url,list:e.list.url},area:{edit:e.edit.area,add:e.add.area,del:e.del.area,chk:e.chk.area},title:{edit:e.edit.title,add:e.add.title,del:e.del.title,chk:e.chk.title,titleStart:e.del.titleStart,titleEnd:e.del.titleEnd},callback:{add:function(){var b=$(".layui-layer .J-school"),c=$(".layui-layer .J-class"),a=$(".J-date"),f=function(){$(".J-date").val(common.getYymmd());common.layerDateYYMM(a);$('input[name\x3d"hasOnlineVideo"]').on("change",function(){var a=$(this);1==a.val()?($(".emptys").show(),$(".J-date").val(common.getYymmd())):($(".emptys").hide(),a.parent().parent().find(".J-date").val(""))})};common.codeFlag(function(){f();common.getSchoolAndClassItem(b,1,c,1,f)},function(){common.getClass(c,1,{page:0,count:0},function(){$(".J-school").text($(".J-sc").text());f()})})},edit:function(){var b=$(".J-school"),c=$(".J-class"),a=$(".J-date"),f=function(){$(".J-date").val(common.getYymmd());common.layerDateYYMM(a);$('input[name\x3d"hasOnlineVideo"]').on("change",function(){var a=$(this);1==a.val()?($(".emptys").show(),$(".J-date").val(common.getYymmd())):($(".emptys").hide(),a.parent().parent().find(".J-date").val(""))})};common.codeFlag(function(){f();common.getSchoolAndClassItem(b,1,c,1,function(){},{schoolId:datasCur.schoolId,schoolName:datasCur.schoolName},{classId:datasCur.classId,className:datasCur.className})},function(){common.getClass(c,1,{page:0,count:0},function(){$(".J-school").text($(".J-sc").text());f()})})},chk:function(){var b=$(".J-school"),c=$(".J-class");b.text($(".J-schools select option:selected").text());c.text($(".J-classs select option:selected").text());$(".layui-layer-btn").remove()}},mmg:{indexCol:!0,checkCol:!0,root:"list"},resetFun:{add:function(){var b=$(".J-addForm"),c=b.serializeArray();common.validformIn(b,function(){common.ajaxFunIframe(addUrl,c,function(){},function(){if(1==ajaxData.success)if(void 0==$("#fileName").prop("files")[0])common.iframeLayerMsg("\u6dfb\u52a0\u6210\u529f!",1,function(){null!=options[0].params?mmg.load(options[0].params):mmg.load()});else{var a=ajaxData.data.id;$.ajax({url:$kidIcon.url,data:{fileName:"kid_"+a},type:"post",cache:!1,dataType:"json",success:function(b){1==b.success&&(Q.AddParams("x:id",a),Q.addEvent("putFinished",function(a,b,c){common.iframeLayerMsg("\u6dfb\u52a0\u6210\u529f!",1,function(){null!=options[0].params?mmg.load(options[0].params):mmg.load()})}),Q.addEvent("putFailure",function(a){alert(a)}),Q.SetToken(b.qiniuTokenStr),Q.Upload($("#fileName").prop("files")[0],"kid_"+a))}})}})})},edit:function(){var b=$(".J-editForm"),c=b.serializeArray();common.validformIn(b,function(){common.ajaxFunIframe(editUrl,c,function(){},function(){1==ajaxData.success&&$.ajax({url:$kidIcon.url,data:{fileName:"kid_"+datasCur.id},type:"post",cache:!1,dataType:"json",success:function(a){if(1==ajaxData.success)if(void 0==$("#fileName").prop("files")[0])common.iframeLayerMsg("\u4fee\u6539\u6210\u529f!",1,function(){null!=options[0].params?mmg.load(options[0].params):mmg.load()});else{var b=datasCur.id;$.ajax({url:$kidIcon.url,data:{fileName:"kid_"+b},type:"post",cache:!1,dataType:"json",success:function(a){1==a.success&&(Q.AddParams("x:id",b),Q.addEvent("putFinished",function(a,b,c){common.iframeLayerMsg("\u4fee\u6539\u6210\u529f!",1,function(){null!=options[0].params?mmg.load(options[0].params):mmg.load()})}),Q.addEvent("putFailure",function(a){alert(a)}),Q.SetToken(a.qiniuTokenStr),Q.Upload($("#fileName").prop("files")[0],"kid_"+b))}})}}})})})}}});bag._do(d,options)},_do:function(e,d){var g=function(b){bag.searchRest();common.creatSearch();void 0==mmg||null==mmg?mainCont.getList(e,d):(common.creatSearch(),_dataParams.pageReset=1,mmg.load(_dataParams));if(mmg)mmg.on("loadSuccess",function(){bag.mmgSelects()})};common.codeFlag(function(){var b=$(".action .J-schools"),c=$(".action .J-classs");common.getSchoolAndClassItem(b,0,c,0,function(){page=1;g(page)})},function(){var b=$(".J-classs");common.getClass(b,0,{page:0,count:0},g)})},creatMmg:function(e,d,g,b,c){tempMmg=$(e).mmGrid({multiSelect:!0,indexCol:d.indexCol,checkCol:d.checkCol,indexColWidth:25,cols:d.it,root:"list",width:"auto",height:"auto",fullWidthRows:!0,autoLoad:!0,noDataText:"\u5f53\u524d\u67e5\u8be2\u672a\u83b7\u53d6\u5230\u4efb\u4f55\u4fe1\u606f",url:d.url,items:d.it,cache:!1,sortStatus:"asc",nowrap:!1,method:"post",showBackboard:!1,params:d.params,plugins:[$(g).mmPaginator({style:"plain",totalCountName:"totalCount",page:1,pageParamName:"page",limitParamName:"count",limitLabel:"\u6bcf\u9875{0}\u6761",totalCountLabel:"\u5171\x3cspan\x3e{0}\x3c/span\x3e\u6761\u8bb0\u5f55",limit:d.it,limitList:[20,30,40,50]})]});tempMmg.on("cellSelected",function(a,c,d,e){b&&b(a,c,d,e)}).on("loadSuccess",function(a,b){c&&c(a,b)})},mmgSelects:function(){mmg.on("cellSelected",function(e,d,g,b){datasCur=d;var c;$(e.target).is(".J-addPer")&&(b=["715px","350px"],g=d.schoolName+"-"+d.className+"-"+d.name+"\u7684\u76d1\u62a4\u4eba\u4fe1\u606f",c=template("tplJhr",datasCur),common.layerConfirm(g,b,c,function(){$(".layui-layer-btn").remove();bag.getJhrList(datasCur.id)}));$(e.target).is(".J-card")&&(b=["715px","50%"],g=d.schoolName+"-"+d.className+"-"+d.name+"\u7684\u95e8\u7981\u5361\u4fe1\u606f",c=template("tplCard",d),common.layerConfirm(g,b,c,function(){$(".layui-layer-btn").remove();bag.getcardList(datasCur.id)}))})},getJhrList:function(e){var d=$("#mmgJhr"),g=$("#paginatorJhr");bag.creatMmg(d,{indexCol:!0,checkCol:!0,it:[{title:"\u5934\u50cf",name:"icon",width:46,align:"center",renderer:function(b,c){var a="";return a=null==b||""==b?null==c.gender||1==c.gender?"\x3cspan class\x3d'avatarMan'\x3e\u7537\x3c/span\x3e":"\x3cspan class\x3d'avatarWomen'\x3e\u5973\x3c/span\x3e":"\x3cspan class\x3d'imgPhoto'\x3e\x3cimg src\x3d'"+b+"'  width\x3d'36px' height\x3d'36px' /\x3e\x3c/span\x3e"}},{title:"\u5173\u7cfb",name:"relationshipId",width:46,align:"center",renderer:function(b,c){var a="";switch(b){case 1:a="\u7236\u4eb2";break;case 2:a="\u6bcd\u4eb2";break;case 3:a="\u7956\u7236";break;case 4:a="\u7956\u6bcd";break;case 5:a="\u5916\u7956\u7236";break;case 6:a="\u5916\u7956\u6bcd";break;case 7:a="\u4f2f\u7236";break;case 8:a="\u4f2f\u6bcd";break;case 9:a="\u53d4\u7236";break;case 10:a="\u53d4\u6bcd";break;case 11:a="\u8205\u8205";break;case 12:a="\u8205\u5988";break;case 13:a="\u59e8\u7236";break;case 14:a="\u59e8\u5988"}return a}},{title:"\u59d3\u540d/\u82f1\u6587\u540d",name:"name",width:100,align:"center",renderer:function(b,c){var a=c.enName,f=c.name;return""==f&&""==a?"\u672a\u8f93\u5165":""==a||null==a?f:""==f||null==f?a:f+"/"+a}},{title:"\u6027\u522b",name:"gender",width:100,align:"center",renderer:function(b,c){var a="";switch(b){case 1:a="\u7537";break;case 0:a="\u5973"}return a}},{title:"\u64cd\u4f5c",width:100,align:"center",renderer:function(b,c){return"\x3cspan class\x3d'table-action'\x3e\x3ca class\x3d'iconfont J-editJhr' href\x3d'javascript:void(0);' title\x3d'\u7f16\u8f91'\x3e\x26#xe61a;\x3c/a\x3e\x3ca class\x3d'iconfont J-delJhr' href\x3d'javascript:void(0);' title\x3d'\u5220\u9664'\x3e\x26#xe625;\x3c/a\x3e\x3c/span\x3e"}}],params:{kidId:e},url:$user.list.url},g,function(b,c,a,f){if($(b.target).is(".J-editJhr")){c.kidId=datasCur.id;c.classId=datasCur.classId;var d=layer.open({type:1,closeBtn:2,content:template("tplJhrForm",c),btn:["\u786e\u5b9a"],area:["700px","350px"],success:function(){var a=$(".J-jhrForm");common.validformSubmit(a)},yes:function(){var a=$(".J-jhrForm");common.validformIn(a,function(){var b=a.serialize();common.ajaxFunIframe($user.edit.url,b,function(){},function(){1==ajaxData.success&&(layer.close(d),jAlert("\u4fee\u6539\u6210\u529f","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){tempMmg.load()}))})})}})}$(b.target).is(".J-delJhr")&&(userData={accountId:c.accountId,kidId:datasCur.id},jConfirm("\u662f\u5426\u522a\u9664\u6b64\u76d1\u62a4\u4eba","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){common.ajaxFunIframe($user.userDel.url,userData,function(){},function(){1==ajaxData.success&&jAlert("\u5220\u9664\u6210\u529f","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){tempMmg.load()})})}))},function(b,c){2<=c.totalCount?$(".J-addJhr").hide():$(".J-addJhr").show()});$(".J-addJhr").on("click",function(){var b=layer.open({type:1,closeBtn:2,content:template("tplTel",{}),btn:["\u4e0b\u4e00\u6b65"],area:["420px","200px"],success:function(){var b=$(".J-telForm");common.validformSubmit(b)},yes:function(){var c=$(".J-telForm");common.validformIn(c,function(){var a=c.serialize();telephone=c.find('input[name\x3d"userName"]').val();common.ajaxFunIframe($user.userDetail.url,a,function(){},function(){if(null!=ajaxData.data&&""!=ajaxData.data)jConfirm("\u76d1\u62a4\u4eba\u8d26\u53f7\u5df2\u5b58\u5728\uff0c\u60a8\u53ef\u4ee5\u8fdb\u5165\u5e76\u5173\u8054\u6b21\u76d1\u62a4\u4eba","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){layer.close(b);var a=ajaxData.data;a.kidId=datasCur.id;a.classId=datasCur.classId;var c=layer.open({type:1,closeBtn:2,content:template("tplJhrForm",a),btn:["\u786e\u5b9a"],area:["700px","350px"],success:function(){var a=$(".J-jhrForm");common.validformSubmit(a)},yes:function(){var a=$(".J-jhrForm");common.validformIn(a,function(){var b=a.serialize();common.ajaxFunIframe($user.edit.url,b,function(){},function(){1==ajaxData.success&&(layer.close(c),jAlert("\u4fee\u6539\u6210\u529f","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){tempMmg.load()}))})})}})},function(){alert("\u53d6\u6d88")});else{layer.close(b);jhrDatas={kidId:datasCur.id,classId:datasCur.classId,telephone:telephone};var a=layer.open({type:1,closeBtn:2,content:template("tplJhrForm",jhrDatas),btn:["\u786e\u5b9a"],area:["700px","350px"],success:function(){var a=$(".J-jhrForm");common.validformSubmit(a)},yes:function(){var b=$(".J-jhrForm");common.validformIn(b,function(){var c=b.serialize();common.ajaxFunIframe($user.add.url,c,function(){},function(){1==ajaxData.success&&(layer.close(a),jAlert("\u4fee\u6539\u6210\u529f","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){tempMmg.load()}))})})}})}})})}})})},getcardList:function(e){var d=[],g=$("#mmgJhr"),b=$("#paginatorJhr");bag.creatMmg(g,{indexCol:!0,checkCol:!0,it:[{title:"\u5361\u53f7",name:"rfId",width:46,align:"center"},{title:"\u76d1\u62a4\u4eba",name:"name",width:46,align:"center"},{title:"\u64cd\u4f5c",width:100,align:"center",renderer:function(b,a){return"\x3cspan class\x3d'table-action'\x3e\x3ca class\x3d'iconfont J-editCard' href\x3d'javascript:void(0);' title\x3d'\u7f16\u8f91'\x3e\x26#xe61a;\x3c/a\x3e\x3ca class\x3d'iconfont J-delCard' href\x3d'javascript:void(0);' title\x3d'\u5220\u9664'\x3e\x26#xe617;\x3c/a\x3e\x3c/span\x3e"}}],params:{kidId:e},url:$kidRfIds.list.url},b,function(b,a,f,e){f=$(tempMmg).find("tbody tr").eq(f);if($(f).hasClass("selected"))for(f=0;f<d.length;f++)a.id==d[f].id&&(d.splice(f,1),f--);else d.push(a);$(b.target).is(".J-editCard")&&common.ajaxSubmitV($user.list.url,{kidId:datasCur.id},function(){var b=layer.open({type:1,closeBtn:2,content:template("tplCardForm",{list:ajaxDatas.list,kidId:datasCur.id,rfId:a.rfId,id:a.id}),btn:["\u786e\u5b9a"],area:["700px","350px"],success:function(){var a=$(".J-Form");common.validformSubmit(a)},yes:function(){var a=$(".J-Form");common.validformIn(a,function(){var c=a.serialize();common.ajaxFunIframe($kidRfIds.edit.url,c,function(){},function(){1==ajaxData.success&&(layer.close(b),jAlert("\u4fee\u6539\u6210\u529f","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){tempMmg.load()}))})})}})});$(b.target).is(".J-delCard")&&(userData={id:[a.id]},jConfirm("\u662f\u5426\u522a\u9664\u6b64\u76d1\u62a4\u4eba\u540d\u4e0b\u7684\u5361","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){common.ajaxFunIframe($kidRfIds.del.url,userData,function(){},function(){1==ajaxData.success&&jAlert("\u5220\u9664\u6210\u529f","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){tempMmg.load()})})}))},function(b,a){$(".checkAll").on("click",function(b){0==$(this).prop("checked")?d=[]:1==a.success&&(d=a.list)});$(".J-delBtnAll").on("click",function(){if(0==d.length)jConfirm("\u672a\u9009\u4e2d\u9700\u8981\u5220\u9664\u7684\u6570\u636e","\u8d1d\u5b89\u6e2f\u63d0\u793a");else{for(var a=[],b=0;b<d.length;b++)a.push(d[b].id);userData={id:a};jConfirm("\u662f\u5426\u522a\u9664\u6b64\u76d1\u62a4\u4eba\u540d\u4e0b\u7684\u5361","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){common.ajaxFunIframe($kidRfIds.del.url,userData,function(){},function(){1==ajaxData.success&&jAlert("\u5220\u9664\u6210\u529f","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){tempMmg.load()})})})}})});$(".J-cardBtn").unbind("click").on("click",function(b){b.preventDefault();common.ajaxSubmitV($user.list.url,{kidId:datasCur.id},function(){if(0==ajaxDatas.totalCount)jAlert("\u8bf7\u5148\u6dfb\u52a0\u76d1\u62a4\u4eba\uff0c\u518d\u6267\u884c\u6b64\u64cd\u4f5c","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){});else var a=layer.open({type:1,title:"\u6dfb\u52a0\u95e8\u7981\u5361",closeBtn:2,content:template("tplCardForm",{list:ajaxDatas.list,kidId:datasCur.id}),btn:["\u4e0b\u4e00\u6b65"],area:["420px","240px"],success:function(){var a=$(".J-Form");common.validformSubmit(a)},yes:function(){var b=$(".J-Form");common.validformIn(b,function(){var c=b.serialize();common.ajaxFunIframe($kidRfIds.add.url,c,function(){},function(){1==ajaxData.success&&jAlert("\u6dfb\u52a0\u6210\u529f","\u8d1d\u5b89\u6e2f\u63d0\u793a",function(){layer.close(a);tempMmg.load()})})})}})})})},formEmpty:function(){$(".J-add-form").empty();$(".J-btn-add").removeClass("disabled")},renderJhrBox:function(e,d,g){$(".J-add-form").html(template("tplJhrForm",e));var b=$(".J-jhrForm");common.validformIn(b,function(){var c=b.serialize();common.ajaxFunIframe(d,c,function(){},function(){1==ajaxData.success&&(sFlag=!1,bag.getJhrList(datasCur.id))})})},ajaxSubmitV:function(e,d,g){$.ajax({type:"post",url:e,data:d,dataType:"json",success:function(b){ajaxDatas=b;g&&g()}})},searchRest:function(){$("#isUse").val("");$("#gender").val("");$("#keyWords").val("")}};bag._init();
//@ sourceMappingURL=b-baobeiguanli.min.js.map