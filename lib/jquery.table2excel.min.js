(function($,window,document,undefined){var pluginName="table2excel",defaults={exclude:".noExl",name:"Table2Excel"};function Plugin(element,options){this.element=element;this.settings=$.extend({},defaults,options);this._defaults=defaults;this._name=pluginName;this.init()}Plugin.prototype={init:function(){var e=this;var utf8Heading='\x3cmeta http-equiv\x3d"content-type" content\x3d"application/vnd.ms-excel; charset\x3dUTF-8"\x3e';e.template={head:'\x3chtml xmlns:o\x3d"urn:schemas-microsoft-com:office:office" xmlns:x\x3d"urn:schemas-microsoft-com:office:excel" xmlns\x3d"http://www.w3.org/TR/REC-html40"\x3e'+utf8Heading+"\x3chead\x3e\x3c!--[if gte mso 9]\x3e\x3cxml\x3e\x3cx:ExcelWorkbook\x3e\x3cx:ExcelWorksheets\x3e",sheet:{head:"\x3cx:ExcelWorksheet\x3e\x3cx:Name\x3e",tail:"\x3c/x:Name\x3e\x3cx:WorksheetOptions\x3e\x3cx:DisplayGridlines/\x3e\x3c/x:WorksheetOptions\x3e\x3c/x:ExcelWorksheet\x3e"},mid:"\x3c/x:ExcelWorksheets\x3e\x3c/x:ExcelWorkbook\x3e\x3c/xml\x3e\x3c![endif]--\x3e\x3c/head\x3e\x3cbody\x3e",table:{head:"\x3ctable\x3e",tail:"\x3c/table\x3e"},foot:"\x3c/body\x3e\x3c/html\x3e"};e.tableRows=[];$(e.element).each(function(i,o){var tempRows="";$(o).find("tr").not(e.settings.exclude).each(function(i,o){tempRows+="\x3ctr\x3e"+$(o).html()+"\x3c/tr\x3e"});e.tableRows.push(tempRows)});e.tableToExcel(e.tableRows,e.settings.name,e.settings.sheetName)},tableToExcel:function(table,name,sheetName){var e=this,fullTemplate="",i,link,a;e.uri="data:application/vnd.ms-excel;base64,";e.base64=function(s){return window.btoa(unescape(encodeURIComponent(s)))};e.format=function(s,c){return s.replace(/{(\w+)}/g,function(m,p){return c[p]})};sheetName=typeof sheetName==="undefined"?"Sheet":sheetName;e.ctx={worksheet:name||"Worksheet",table:table,sheetName:sheetName};fullTemplate=e.template.head;if($.isArray(table))for(i in table)fullTemplate+=e.template.sheet.head+sheetName+i+e.template.sheet.tail;fullTemplate+=e.template.mid;if($.isArray(table))for(i in table)fullTemplate+=e.template.table.head+"{table"+i+"}"+e.template.table.tail;fullTemplate+=e.template.foot;for(i in table)e.ctx["table"+i]=table[i];delete e.ctx.table;if(typeof msie!=="undefined"&&msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./))if(typeof Blob!=="undefined"){fullTemplate=[fullTemplate];var blob1=new Blob(fullTemplate,{type:"text/html"});window.navigator.msSaveBlob(blob1,getFileName(e.settings))}else{txtArea1.document.open("text/html","replace");txtArea1.document.write(e.format(fullTemplate,e.ctx));txtArea1.document.close();txtArea1.focus();sa=txtArea1.document.execCommand("SaveAs",true,getFileName(e.settings))}else{link=e.uri+e.base64(e.format(fullTemplate,e.ctx));a=document.createElement("a");a.download=getFileName(e.settings);a.href=link;document.body.appendChild(a);a.click();document.body.removeChild(a)}return true}};function getFileName(settings){return settings.filename?settings.filename:"table2excel"}$.fn[pluginName]=function(options){var e=this;e.each(function(){if(!$.data(e,"plugin_"+pluginName))$.data(e,"plugin_"+pluginName,new Plugin(this,options))});return e}})(jQuery,window,document);
//@ sourceMappingURL=jquery.table2excel.min.js.map